<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Move Water Move</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #f4f4f4;
      margin: 0;
      padding: 20px;
    }
    h1 {
      font-size: 2em;
      margin-bottom: 10px;
    }
    .board {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      height: 300px;
      position: relative;
      margin-bottom: 20px;
    }
    .bowl {
      width: 100px;
      height: 100px;
      border: 4px solid gray;
      border-radius: 50%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-size: 1.5em;
      margin: 10px;
      background: white;
      transition: border 0.3s;
      position: absolute;
    }
    .bowl.player {
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      border-color: blue;
    }
    .bowl.left {
      top: 0;
      left: 0;
    }
    .bowl.right {
      top: 0;
      right: 0;
    }
    .controls button {
      padding: 10px 20px;
      font-size: 1em;
      margin: 10px;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.6);
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 8px;
      max-width: 400px;
      text-align: left;
    }
  </style>
</head>
<body>
  <h1>Move Water Move</h1>
  <div class="board" id="board"></div>
  <div class="controls">
    <button onclick="rollDice()">Roll Dice 🎲</button>
    <button onclick="restartGame()">Restart</button>
    <button onclick="showModal()">How to Play</button>
  </div>
  <div id="status"></div>
  <div id="log" style="margin-top:20px; white-space:pre-wrap;"></div>  <div id="howToPlay" class="modal" onclick="hideModal()">
    <div class="modal-content">
      <h3>How to Play</h3>
      <p>
        1. You control one bowl (Rain, River, or Clouds) and try to reach 21 seeds first.<br>
        2. On your turn, roll the dice.<br>
        3. If you roll 1, your element rotates and the turn ends.<br>
        4. Otherwise, place seeds one at a time across any bowl.<br>
        5. AI players Osi and Obasa take their turns too.<br>
        6. First to 21 seeds in their active bowl wins.
      </p>
    </div>
  </div>  <script>
    const elements = ["Rain", "River", "Clouds"];
    const icons = { Rain: "🌧️", River: "🌊", Clouds: "☁️" };
    let bowls = [0, 0, 0];
    let playerIndex = 0;
    let seedCount = 0;
    let gameOver = false;

    const board = document.getElementById("board");
    const status = document.getElementById("status");
    const log = document.getElementById("log");

    function renderBoard() {
      board.innerHTML = "";
      elements.forEach((el, i) => {
        const bowl = document.createElement("div");
        bowl.className = "bowl";
        if (i === playerIndex) bowl.classList.add("player");
        if (i === (playerIndex + 1) % 3) bowl.classList.add("left");
        if (i === (playerIndex + 2) % 3) bowl.classList.add("right");
        bowl.innerHTML = `${icons[el]}<br><strong>${el}</strong><br>${bowls[i]}`;
        bowl.onclick = () => placeSeed(i);
        board.appendChild(bowl);
      });
    }

    function rollDice() {
      if (seedCount > 0 || gameOver) return;
      const roll = Math.ceil(Math.random() * 6);
      status.innerText = `You rolled a ${roll}.`;
      if (roll === 1) {
        playerIndex = (playerIndex + 1) % 3;
        renderBoard();
        setTimeout(aiTurns, 500);
      } else {
        seedCount = roll;
      }
    }

    function placeSeed(i) {
      if (seedCount <= 0 || gameOver) return;
      bowls[i]++;
      seedCount--;
      renderBoard();
      if (bowls[i] >= 21) return endGame(i);
      if (seedCount === 0) setTimeout(aiTurns, 500);
    }

    function aiTurns() {
      const players = ["Osi", "Obasa"];
      let aiIndex = 1;

      function takeTurn() {
        if (aiIndex > 2) return;
        const name = players[aiIndex - 1];
        const roll = Math.ceil(Math.random() * 6);
        log.innerText += `\n${name} rolls ${roll}`;
        if (roll === 1) {
          playerIndex = (playerIndex + 1) % 3;
          renderBoard();
          log.innerText += `\n${name} rotated to ${elements[playerIndex]}`;
          aiIndex++;
          return setTimeout(takeTurn, 1500);
        }

        let toAdd = roll;
        const current = (playerIndex + aiIndex) % 3;
        if (bowls[current] + roll === 21) {
          bowls[current] += roll;
          log.innerText += `\n${name} adds ${roll} to ${elements[current]}`;
          renderBoard();
          return endGame(current, name);
        }

        while (toAdd > 0) {
          const targets = [0, 1, 2];
          const choice = targets[Math.floor(Math.random() * 3)];
          bowls[choice]++;
          log.innerText += `\n${name} adds 1 to ${elements[choice]}`;
          toAdd--;
        }

        renderBoard();
        aiIndex++;
        setTimeout(takeTurn, 1500);
      }

      takeTurn();
    }

    function endGame(winnerIndex, name = "You") {
      gameOver = true;
      status.innerText = `${name} win${name === "You" ? "!" : "s!"}`;
    }

    function restartGame() {
      bowls = [0, 0, 0];
      seedCount = 0;
      gameOver = false;
      playerIndex = 0;
      log.innerText = "";
      status.innerText = "";
      renderBoard();
    }

    function showModal() {
      document.getElementById("howToPlay").style.display = "flex";
    }

    function hideModal() {
      document.getElementById("howToPlay").style.display = "none";
    }

    renderBoard();
  </script></body>
</html>

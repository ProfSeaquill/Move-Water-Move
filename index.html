<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Move Water Move</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background-color: #f0f8ff;
    }
    h1 {
      margin-top: 10px;
    }
    #game {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 20px;
    }
    #board {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 60px;
    }
    .bowl-row {
      display: flex;
      justify-content: center;
      gap: 100px;
    }
    .bowl {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      border: 4px solid gray;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background-color: white;
      position: relative;
      font-size: 20px;
    }
    .bowl.active {
      border-color: blue;
      box-shadow: 0 0 15px blue;
    }
    .icon {
      font-size: 30px;
    }
    .controls {
      margin-top: 20px;
    }
    .log {
      margin-top: 20px;
      max-height: 200px;
      overflow-y: auto;
      border: 1px solid #ccc;
      padding: 10px;
      width: 300px;
      text-align: left;
    }
    .bold {
      font-weight: bold;
    }
    button {
      margin: 5px;
      padding: 10px 20px;
    }
    #modal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      border: 2px solid #000;
      padding: 20px;
      z-index: 1000;
    }
    #overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 999;
    }
  </style>
</head>
<body>
  <h1>Move Water Move</h1>
  <div id="game">
    <div id="board">
      <div class="bowl-row">
        <div class="bowl" id="osi">
          <div id="osi-icon" class="icon">‚òÅÔ∏è</div>
          <div id="osi-count">0</div>
          <div>Osi</div>
        </div>
        <div class="bowl" id="obasa">
          <div id="obasa-icon" class="icon">üíß</div>
          <div id="obasa-count">0</div>
          <div>Obasa</div>
        </div>
      </div>
      <div class="bowl-row">
        <div class="bowl active" id="player">
          <div id="player-icon" class="icon">üåßÔ∏è</div>
          <div id="player-count">0</div>
          <div>You</div>
        </div>
      </div>
    </div>
    <div class="controls">
      <button id="rollButton">Roll Dice</button>
      <button id="restartButton">Restart</button>
      <button id="howToPlayButton">How to Play</button>
    </div>
    <div class="log" id="log"></div>
  </div>  <div id="overlay"></div>
  <div id="modal">
    <h2>How to Play</h2>
    <p>Roll the die and place the rolled number of seeds in one or more bowls. If you roll a 1, the board rotates and you take control of a new element (Rain ‚Üí River ‚Üí Clouds ‚Üí Rain). First to reach 21 seeds wins. AIs Obasa and Osi play after your turn. If they roll a 1, they rotate too.</p>
    <button onclick="closeModal()">Close</button>
  </div>  <script>
    const bowls = {
      player: { element: 'Rain', count: 0, icon: 'üåßÔ∏è' },
      osi: { element: 'Cloud', count: 0, icon: '‚òÅÔ∏è' },
      obasa: { element: 'River', count: 0, icon: 'üíß' }
    };
    const order = ['Rain', 'River', 'Cloud'];
    let playerElementIndex = 0;
    let rolledNumber = 0;
    let remainingSeeds = 0;
    let gameOver = false;

    const logEl = document.getElementById("log");

    function updateBoard() {
      document.getElementById("player-icon").textContent = bowls.player.icon;
      document.getElementById("player-count").textContent = bowls.player.count;
      document.getElementById("osi-icon").textContent = bowls.osi.icon;
      document.getElementById("osi-count").textContent = bowls.osi.count;
      document.getElementById("obasa-icon").textContent = bowls.obasa.icon;
      document.getElementById("obasa-count").textContent = bowls.obasa.count;
    }

    function logMessage(message, isBold = false) {
      const p = document.createElement("p");
      if (isBold) p.classList.add("bold");
      p.textContent = "";
      const parent = logEl;
      parent.insertBefore(p, parent.firstChild);
      let i = 0;
      const interval = setInterval(() => {
        p.textContent += message[i];
        i++;
        if (i >= message.length) clearInterval(interval);
      }, 20);
    }

    function rollDice() {
      if (gameOver) return;
      rolledNumber = Math.floor(Math.random() * 6) + 1;
      if (rolledNumber === 1) {
        playerElementIndex = (playerElementIndex + 1) % 3;
        const newElement = order[playerElementIndex];
        const iconMap = { Rain: 'üåßÔ∏è', River: 'üíß', Cloud: '‚òÅÔ∏è' };
        bowls.player.element = newElement;
        bowls.player.icon = iconMap[newElement];
        logMessage(`You now control the ${newElement}`, true);
        updateBoard();
        setTimeout(() => { takeAITurn("osi"); }, 1000);
        return;
      }
      remainingSeeds = rolledNumber;
      alert(`You rolled a ${rolledNumber}. Tap your bowl or others to place your seeds.`);
    }

    function placeSeed(bowlId) {
      if (gameOver || remainingSeeds <= 0) return;
      bowls[bowlId].count++;
      remainingSeeds--;
      updateBoard();
      if (remainingSeeds === 0) {
        checkWinner();
        if (!gameOver) setTimeout(() => { takeAITurn("osi"); }, 1000);
      }
    }

    function takeAITurn(aiId) {
      if (gameOver) return;
      const ai = bowls[aiId];
      const iconMap = { Rain: 'üåßÔ∏è', River: 'üíß', Cloud: '‚òÅÔ∏è' };
      const aiOrder = ['Rain', 'River', 'Cloud'];
      let aiElementIndex = aiOrder.indexOf(ai.element);

      let roll = Math.floor(Math.random() * 6) + 1;
      logMessage(`${aiId.charAt(0).toUpperCase() + aiId.slice(1)} rolls ${roll}`);

      if (roll === 1) {
        aiElementIndex = (aiElementIndex + 1) % 3;
        ai.element = aiOrder[aiElementIndex];
        ai.icon = iconMap[ai.element];
        logMessage(`${aiId.charAt(0).toUpperCase() + aiId.slice(1)} now controls the ${ai.element}`, true);
        updateBoard();
        setTimeout(() => takeAITurn(aiId === "osi" ? "obasa" : null), 1000);
        return;
      }

      let seedsToSelf = 0;
      if (ai.count + roll === 21) {
        seedsToSelf = roll;
      } else {
        seedsToSelf = Math.floor(Math.random() * (roll + 1));
      }
      const seedsToOthers = roll - seedsToSelf;
      ai.count += seedsToSelf;

      if (seedsToSelf > 0) logMessage(`${aiId.charAt(0).toUpperCase() + aiId.slice(1)} adds ${seedsToSelf} seeds to the ${ai.element}`);

      if (seedsToOthers > 0) {
        const otherId = aiId === "osi" ? "obasa" : "osi";
        bowls[otherId].count += seedsToOthers;
        logMessage(`${aiId.charAt(0).toUpperCase() + aiId.slice(1)} adds ${seedsToOthers} seeds to the ${bowls[otherId].element}`);
      }

      updateBoard();
      checkWinner();
      if (aiId === "osi" && !gameOver) setTimeout(() => takeAITurn("obasa"), 2000);
    }

    function checkWinner() {
      for (const id in bowls) {
        if (bowls[id].count >= 21) {
          gameOver = true;
          alert(`${id === "player" ? "You" : id.charAt(0).toUpperCase() + id.slice(1)} win!`);
          return;
        }
      }
    }

    function restartGame() {
      for (const id in bowls) bowls[id].count = 0;
      bowls.player.element = 'Rain';
      bowls.player.icon = 'üåßÔ∏è';
      playerElementIndex = 0;
      gameOver = false;
      updateBoard();
      logEl.innerHTML = "";
    }

    function openModal() {
      document.getElementById("modal").style.display = "block";
      document.getElementById("overlay").style.display = "block";
    }
    function closeModal() {
      document.getElementById("modal").style.display = "none";
      document.getElementById("overlay").style.display = "none";
    }

    document.getElementById("rollButton").addEventListener("click", rollDice);
    document.getElementById("restartButton").addEventListener("click", restartGame);
    document.getElementById("howToPlayButton").addEventListener("click", openModal);

    document.getElementById("player").addEventListener("click", () => placeSeed("player"));
    document.getElementById("osi").addEventListener("click", () => placeSeed("osi"));
    document.getElementById("obasa").addEventListener("click", () => placeSeed("obasa"));

    updateBoard();
  </script></body>
</html>
